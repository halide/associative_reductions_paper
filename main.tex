% This is "sig-alternate.tex" V2.1 April 2013
% This file should be compiled with V2.5 of "sig-alternate.cls" May 2012
%
% This example file demonstrates the use of the 'sig-alternate.cls'
% V2.5 LaTeX2e document class file. It is for those submitting
% articles to ACM Conference Proceedings WHO DO NOT WISH TO
% STRICTLY ADHERE TO THE SIGS (PUBS-BOARD-ENDORSED) STYLE.
% The 'sig-alternate.cls' file will produce a similar-looking,
% albeit, 'tighter' paper resulting in, invariably, fewer pages.
%
% ----------------------------------------------------------------------------------------------------------------
% This .tex file (and associated .cls V2.5) produces:
%       1) The Permission Statement
%       2) The Conference (location) Info information
%       3) The Copyright Line with ACM data
%       4) NO page numbers
%
% as against the acm_proc_article-sp.cls file which
% DOES NOT produce 1) thru' 3) above.
%
% Using 'sig-alternate.cls' you have control, however, from within
% the source .tex file, over both the CopyrightYear
% (defaulted to 200X) and the ACM Copyright Data
% (defaulted to X-XXXXX-XX-X/XX/XX).
% e.g.
% \CopyrightYear{2007} will cause 2007 to appear in the copyright line.
% \crdata{0-12345-67-8/90/12} will cause 0-12345-67-8/90/12 to appear in the copyright line.
%
% ---------------------------------------------------------------------------------------------------------------
% This .tex source is an example which *does* use
% the .bib file (from which the .bbl file % is produced).
% REMEMBER HOWEVER: After having produced the .bbl file,
% and prior to final submission, you *NEED* to 'insert'
% your .bbl file into your source .tex file so as to provide
% ONE 'self-contained' source file.
%
% ================= IF YOU HAVE QUESTIONS =======================
% Questions regarding the SIGS styles, SIGS policies and
% procedures, Conferences etc. should be sent to
% Adrienne Griscti (griscti@acm.org)
%
% Technical questions _only_ to
% Gerald Murray (murray@hq.acm.org)
% ===============================================================
%
% For tracking purposes - this is V2.0 - May 2012

\documentclass{main}
\pagenumbering{arabic}

\usepackage{listings}

\begin{document}

% Copyright
%\setcopyright{acmcopyright}
%\setcopyright{acmlicensed}
%\setcopyright{rightsretained}
%\setcopyright{usgov}
%\setcopyright{usgovmixed}
%\setcopyright{cagov}
%\setcopyright{cagovmixed}


\title{Parallel Associative Reductions in Halide}

%\numberofauthors{3}
%\author{
%% 1st. author
%\alignauthor
%Ben Trovato\titlenote{Dr.~Trovato insisted his name be first.}\\
%       \affaddr{Institute for Clarity in Documentation}\\
%       \affaddr{1932 Wallamaloo Lane}\\
%       \affaddr{Wallamaloo, New Zealand}\\
%       \email{trovato@corporation.com}
%% 2nd. author
%\alignauthor
%G.K.M. Tobin\titlenote{The secretary disavows
%any knowledge of this author's actions.}\\
%       \affaddr{Institute for Clarity in Documentation}\\
%       \affaddr{P.O. Box 1212}\\
%       \affaddr{Dublin, Ohio 43017-6221}\\
%       \email{webmaster@marysville-ohio.com}
%% 3rd. author
%\alignauthor Lars Th{\o}rv{\"a}ld\titlenote{This author is the
%one who did all the really hard work.}\\
%       \affaddr{The Th{\o}rv{\"a}ld Group}\\
%       \affaddr{1 Th{\o}rv{\"a}ld Circle}\\
%       \affaddr{Hekla, Iceland}\\
%       \email{larst@affiliation.org}
%}

\maketitle
\begin{abstract}

Halide is a domain-specific language for fast image processing in heavy use in industry. It partitions pipelines into the \emph{algorithm}, which defines \emph{what} values are computed, and the \emph{schedule}, which defines \emph{how} they are computed. While Halide supports parallelizing and vectorizing naturally data-parallel operations, such as resizing an image, it doesn't have first-class parallel reductions. To parallelize or vectorize a reduction, the programmer must manually factor a reduction into multiple stages to create new opportunities for data parallelism. For example, one might parallelize the computation of the histogram of an image by first computing the histogram of each row in parallel, and then summing those partial histograms. This manipulation of the \emph{algorithm} can introduce bugs, make the algorithm harder to understand, and hurts portability. We describe a new Halide scheduling primitive ``rfactor'' which moves this factoring into the \emph{schedule}, and provides the same guarantees as the rest of the scheduling language: changes to the schedule can't change the output values or introduce race conditions. Our technique take serial Halide reductions (expressed using unstructured ``update'' definitions), and synthesizes an equivalent binary associative reduction operator and its identity. During compilation, we replace the original pipeline stage with a pair of stages that first computes partial results over slices of the domain of the reduction, and then combines them. Our technique permits parallelization and vectorization of Halide algorithms for which this was not previously possible, and can thus accelerate them by more than an order of magnitude.

\end{abstract}


%
%  Use this command to print the description
%
\printccsdesc

%\keywords{ACM proceedings; \LaTeX; text tagging}

\section{Introduction}
\input{introduction}

\section{Background and Related Work}
\input{background}

\section{Associative Reduction in Halide}
\input{assoc_red}

\section{Evaluation}
\input{evaluation}

\section{Discussion}
\input{discussion}

\bibliographystyle{abbrv}
\bibliography{sigproc}  % sigproc.bib is the name of the Bibliography in this case
% You must have a proper ".bib" file
%  and remember to run:
% latex bibtex latex latex
% to resolve all references
%
% ACM needs 'a single self-contained file'!
%
\end{document}
